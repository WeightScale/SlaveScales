<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no'/>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
    <meta http-equiv="Pragma" content="no-cache"/>
    <title>Настройки</title>
    <link rel="stylesheet" type="text/css" href="global.css">
    <style>
        input:focus{background: #FA6;outline: none;}
        table{width:100%;}
        input{width:100%;text-align:right;font-size:18px;}
        input[type=submit]{width:auto;}
    </style>
    <script>
        function GetValue(){
            var req=new XMLHttpRequest();
            req.overrideMimeType('application/json');
            req.onreadystatechange=function(){
                if (this.readyState===4 ){
                    if(this.status===200){
                        var json=JSON.parse(this.responseText);
                        for (entry in json){
                            try{
                                document.getElementById(entry).innerHTML=json[entry];
                            }catch (e){}
                        }
                    }
                }
            };
            req.open("GET", "/sv", true);
            req.send(null);
        }
        function GetSettings(){
            var req=new XMLHttpRequest();
            req.overrideMimeType('application/json');
            req.onreadystatechange=function(){
                if (this.readyState===4){
                    if(this.status===200){
                        try{
                            var json=JSON.parse(req.responseText);
                            var scale=json.scale;
                            for (entry in scale){
                                try{
                                    document.getElementById(entry).value=scale[entry];
                                }catch (e){}
                            }
                            var server=json.server;
                            for (entry in server){
                                try{
                                    document.getElementById(entry).value=server[entry];
                                }catch (e){}
                            }
                        }catch(e){
                            alert(e.toString());
                        }finally{
                            document.body.style.visibility='visible';
                            GetValue();
                        }
                    }
                }
            };
            req.open("GET", "/settings.json", true);
            req.send(null);
        }
        window.onload=function(){
            GetSettings();
        };
    </script>
</head>
<body style="visibility: hidden"><strong>Настройки</strong>
<hr>
<br/>
<fieldset style="width: auto"><details><summary>Общии настройки</summary>
    <br>
    <form method='POST'>
        <h5>Доступ к настройкам</h5>
        <table>
            <tr>
                <td>ИМЯ:</td>
                <td><input id="id_name_admin" name="name_admin" placeholder='имя админ'></td>
            </tr>
            <tr>
                <td>ПАРОЛЬ:</td>
                <td><input type="password" id="id_pass_admin" name="pass_admin" placeholder='пароль админ'></td>
            </tr>
            <tr>
                <td></td>
                <td><input type='submit' value='СОХРАНИТЬ'/></td>
            </tr>
        </table>
    </form>
</details>
</fieldset>
<br/>
<fieldset>
    <details><summary>Информация</summary>
        <br>
        <table>
            <tr>
                <td><h5>Имя хоста:</h5></td>
                <td align="right"><h5 id="id_local_host"></h5></td>
            </tr>
        </table>
        <hr>
        <h5 align='left'><b>Точка доступа весов</b></h5>
        <table>
            <tr>
                <td id="id_ap_ssid"></td>
                <td align="right" id="id_ap_ip"></td>
            </tr>
        </table>
        <hr>
        <table>
            <tr>
                <td>Пломба:</td>
                <td align="right"><div id="sl_id"></div></td>
            </tr>
        </table>
        <hr>
        <a href='/calibr.html'>калибровка</a>
    </details>
</fieldset>
<hr>
<footer align="center">2018 © Powered by www.scale.in.ua</footer>
</body>
</html>